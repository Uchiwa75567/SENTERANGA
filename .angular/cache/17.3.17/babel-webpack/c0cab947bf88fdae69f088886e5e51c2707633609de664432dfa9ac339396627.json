{"ast":null,"code":"import { CommonModule } from '@angular/common';\nimport { RouterModule } from '@angular/router';\nimport { HeaderComponent } from '../../components/header/header.component';\nimport { FooterComponent } from '../../components/footer/footer.component';\nimport { ReactiveFormsModule, FormsModule } from '@angular/forms';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../services/data.service\";\nimport * as i2 from \"@angular/forms\";\nimport * as i3 from \"@angular/common\";\nfunction DashboardAgriculteurComponent_div_17_li_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"li\", 31)(1, \"div\", 32);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementStart(3, \"span\", 33);\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(5, \"div\", 34);\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const a_r1 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"\", a_r1.title, \" \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"(\", a_r1.status, \")\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(a_r1.description);\n  }\n}\nfunction DashboardAgriculteurComponent_div_17_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 27)(1, \"h4\", 28);\n    i0.ɵɵtext(2, \"Mes publications\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"ul\", 29);\n    i0.ɵɵtemplate(4, DashboardAgriculteurComponent_div_17_li_4_Template, 7, 3, \"li\", 30);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r1.announcements);\n  }\n}\nfunction DashboardAgriculteurComponent_div_28_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 35);\n    i0.ɵɵtext(1, \"Aucun produit trouv\\u00E9.\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction DashboardAgriculteurComponent_div_29_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r3 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 38)(1, \"div\", 39);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"div\", 13);\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"div\", 40)(6, \"input\", 41);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function DashboardAgriculteurComponent_div_29_div_1_Template_input_ngModelChange_6_listener($event) {\n      const s_r4 = i0.ɵɵrestoreView(_r3).$implicit;\n      const ctx_r1 = i0.ɵɵnextContext(2);\n      i0.ɵɵtwoWayBindingSet(ctx_r1.seedOrderQty[s_r4.id], $event) || (ctx_r1.seedOrderQty[s_r4.id] = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"button\", 42);\n    i0.ɵɵlistener(\"click\", function DashboardAgriculteurComponent_div_29_div_1_Template_button_click_7_listener() {\n      const s_r4 = i0.ɵɵrestoreView(_r3).$implicit;\n      const ctx_r1 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r1.orderSeed(s_r4));\n    });\n    i0.ɵɵtext(8, \"Commander\");\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const s_r4 = ctx.$implicit;\n    const ctx_r1 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(s_r4.name);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate2(\"Prix: \", s_r4.price, \" FCFA / \", s_r4.unit || \"unit\\u00E9\", \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r1.seedOrderQty[s_r4.id]);\n  }\n}\nfunction DashboardAgriculteurComponent_div_29_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 36);\n    i0.ɵɵtemplate(1, DashboardAgriculteurComponent_div_29_div_1_Template, 9, 4, \"div\", 37);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngForOf\", ctx_r1.seeds);\n  }\n}\nfunction DashboardAgriculteurComponent_li_35_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"li\", 43)(1, \"div\", 39);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"div\", 34);\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const n_r5 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(n_r5.title);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(n_r5.message);\n  }\n}\nfunction DashboardAgriculteurComponent_div_54_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 13);\n    i0.ɵɵtext(1, \"Aucune alerte pour votre r\\u00E9gion pour le moment.\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction DashboardAgriculteurComponent_ul_55_li_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"li\", 43)(1, \"div\", 39);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"div\", 34);\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const a_r6 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(a_r6.title);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(a_r6.message);\n  }\n}\nfunction DashboardAgriculteurComponent_ul_55_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ul\");\n    i0.ɵɵtemplate(1, DashboardAgriculteurComponent_ul_55_li_1_Template, 5, 2, \"li\", 19);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngForOf\", ctx_r1.alerts);\n  }\n}\nexport let DashboardAgriculteurComponent = /*#__PURE__*/(() => {\n  class DashboardAgriculteurComponent {\n    constructor(dataService, fb) {\n      this.dataService = dataService;\n      this.fb = fb;\n      // Minimal placeholder data / bindings\n      this.notifications = [];\n      this.announcements = [];\n      this.seeds = [];\n      this.seedOrderQty = {};\n      this.alerts = [];\n      this.currentUser = null;\n    }\n    ngOnInit() {\n      const raw = localStorage.getItem('currentUser');\n      this.currentUser = raw ? JSON.parse(raw) : null;\n      // initialize forms\n      this.bankForm = this.fb.group({\n        bankName: [''],\n        accountNumber: ['']\n      });\n      this.publishForm = this.fb.group({\n        title: [''],\n        description: ['']\n      });\n      this.loadInitial();\n    }\n    loadInitial() {\n      if (!this.currentUser) return;\n      // Notifications\n      this.dataService.getNotificationsForUser(this.currentUser.id).subscribe(list => this.notifications = list || []);\n      // Announcements by user\n      this.dataService.getAnnouncementsByUser(this.currentUser.id).subscribe(list => this.announcements = list || []);\n      // Seeds catalog\n      this.dataService.getSeedsCatalog().subscribe(list => {\n        this.seeds = list || [];\n        this.seeds.forEach(s => this.seedOrderQty[s.id] = 1);\n      });\n      // Alerts filtered by region\n      if (this.currentUser.region) {\n        this.dataService.getAlertsByRegion(this.currentUser.region).subscribe(list => this.alerts = list || []);\n      }\n      // Bank info prefill\n      if (this.currentUser.bankAccount) {\n        this.bankForm.patchValue(this.currentUser.bankAccount);\n      }\n    }\n    // Publish an announcement\n    publish() {\n      if (!this.currentUser) return;\n      const payload = {\n        id: `ann-${Date.now()}`,\n        userId: this.currentUser.id,\n        title: this.publishForm.value.title,\n        description: this.publishForm.value.description,\n        createdAt: new Date().toISOString(),\n        status: 'pending'\n      };\n      this.dataService.createAnnouncement(payload).subscribe({\n        next: res => {\n          this.announcements.unshift(res);\n          alert('Annonce publiée — en attente de validation');\n          this.publishForm.reset();\n        },\n        error: err => {\n          console.error('Error publishing announcement', err);\n          alert('Erreur lors de la publication');\n        }\n      });\n    }\n    // Bank account save (simulation)\n    saveBankAccount() {\n      if (!this.currentUser) return;\n      const bank = this.bankForm.value;\n      // Ensure strings\n      const payload = {\n        bankName: bank.bankName || '',\n        accountNumber: bank.accountNumber || ''\n      };\n      this.dataService.updateUserBankAccount(this.currentUser.id, payload).subscribe({\n        next: u => {\n          this.currentUser = u;\n          localStorage.setItem('currentUser', JSON.stringify(u));\n          alert('Compte bancaire enregistré (simulation)');\n        },\n        error: err => {\n          console.error(err);\n          alert('Erreur lors de l\\'enregistrement');\n        }\n      });\n    }\n    orderSeed(seed) {\n      if (!this.currentUser) return;\n      const qty = this.seedOrderQty[seed.id] || 1;\n      const order = {\n        id: `order-${Date.now()}`,\n        userId: this.currentUser.id,\n        seedId: seed.id,\n        seedName: seed.name,\n        quantity: qty,\n        total: (seed.price || 0) * qty,\n        status: 'paid',\n        createdAt: new Date().toISOString()\n      };\n      this.dataService.createSeedOrder(order).subscribe({\n        next: res => {\n          alert(`Commande passée: ${order.seedName} x${qty} — Paiement simulé`);\n        },\n        error: err => {\n          console.error(err);\n          alert('Erreur lors de la commande');\n        }\n      });\n    }\n    static {\n      this.ɵfac = function DashboardAgriculteurComponent_Factory(t) {\n        return new (t || DashboardAgriculteurComponent)(i0.ɵɵdirectiveInject(i1.DataService), i0.ɵɵdirectiveInject(i2.FormBuilder));\n      };\n    }\n    static {\n      this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n        type: DashboardAgriculteurComponent,\n        selectors: [[\"app-dashboard-agriculteur\"]],\n        standalone: true,\n        features: [i0.ɵɵStandaloneFeature],\n        decls: 57,\n        vars: 8,\n        consts: [[1, \"pt-20\", \"max-w-7xl\", \"mx-auto\", \"px-6\", \"py-8\"], [1, \"text-3xl\", \"font-bold\", \"mb-4\"], [1, \"grid\", \"grid-cols-1\", \"lg:grid-cols-3\", \"gap-6\"], [1, \"col-span-2\", \"space-y-6\"], [1, \"bg-white\", \"rounded-lg\", \"shadow\", \"p-6\"], [1, \"text-xl\", \"font-semibold\", \"mb-2\"], [1, \"space-y-3\", 3, \"ngSubmit\", \"formGroup\"], [\"formControlName\", \"title\", \"placeholder\", \"Titre\", 1, \"w-full\", \"border\", \"rounded\", \"px-3\", \"py-2\"], [\"formControlName\", \"description\", \"rows\", \"4\", \"placeholder\", \"Description\", 1, \"w-full\", \"border\", \"rounded\", \"px-3\", \"py-2\"], [1, \"flex\", \"gap-2\"], [\"type\", \"submit\", 1, \"px-4\", \"py-2\", \"bg-green-600\", \"text-white\", \"rounded\"], [\"type\", \"button\", 1, \"px-4\", \"py-2\", \"bg-gray-200\", \"rounded\", 3, \"click\"], [\"class\", \"mt-4\", 4, \"ngIf\"], [1, \"text-sm\", \"text-gray-600\"], [\"class\", \"text-sm text-gray-600 mt-2\", 4, \"ngIf\"], [\"class\", \"grid grid-cols-1 md:grid-cols-2 gap-4 mt-3\", 4, \"ngIf\"], [1, \"space-y-6\"], [1, \"bg-white\", \"rounded-lg\", \"shadow\", \"p-4\"], [1, \"font-semibold\", \"mb-2\"], [\"class\", \"text-sm py-1 border-b last:border-b-0\", 4, \"ngFor\", \"ngForOf\"], [1, \"space-y-2\", \"mt-2\", 3, \"ngSubmit\", \"formGroup\"], [\"formControlName\", \"bankName\", \"placeholder\", \"Nom de la banque\", 1, \"w-full\", \"border\", \"rounded\", \"px-3\", \"py-2\"], [\"formControlName\", \"accountNumber\", \"placeholder\", \"Num\\u00E9ro de compte\", 1, \"w-full\", \"border\", \"rounded\", \"px-3\", \"py-2\"], [\"type\", \"submit\", 1, \"px-3\", \"py-1\", \"bg-green-600\", \"text-white\", \"rounded\"], [\"type\", \"button\", 1, \"px-3\", \"py-1\", \"bg-gray-200\", \"rounded\", 3, \"click\"], [\"class\", \"text-sm text-gray-600\", 4, \"ngIf\"], [4, \"ngIf\"], [1, \"mt-4\"], [1, \"font-semibold\"], [1, \"mt-2\"], [\"class\", \"py-2 border-b last:border-b-0\", 4, \"ngFor\", \"ngForOf\"], [1, \"py-2\", \"border-b\", \"last:border-b-0\"], [1, \"text-sm\", \"font-medium\"], [1, \"text-xs\", \"text-gray-500\"], [1, \"text-xs\", \"text-gray-600\"], [1, \"text-sm\", \"text-gray-600\", \"mt-2\"], [1, \"grid\", \"grid-cols-1\", \"md:grid-cols-2\", \"gap-4\", \"mt-3\"], [\"class\", \"border rounded p-3\", 4, \"ngFor\", \"ngForOf\"], [1, \"border\", \"rounded\", \"p-3\"], [1, \"font-medium\"], [1, \"mt-2\", \"flex\", \"items-center\", \"gap-2\"], [\"type\", \"number\", \"min\", \"1\", 1, \"w-20\", \"border\", \"rounded\", \"px-2\", \"py-1\", 3, \"ngModelChange\", \"ngModel\"], [1, \"px-3\", \"py-1\", \"bg-senteranga-green\", \"text-white\", \"rounded\", 3, \"click\"], [1, \"text-sm\", \"py-1\", \"border-b\", \"last:border-b-0\"]],\n        template: function DashboardAgriculteurComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.ɵɵelement(0, \"app-header\");\n            i0.ɵɵelementStart(1, \"section\", 0)(2, \"h1\", 1);\n            i0.ɵɵtext(3, \"Espace Agriculteur\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(4, \"div\", 2)(5, \"div\", 3)(6, \"div\", 4)(7, \"h2\", 5);\n            i0.ɵɵtext(8, \"Publier une annonce / r\\u00E9colte\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(9, \"form\", 6);\n            i0.ɵɵlistener(\"ngSubmit\", function DashboardAgriculteurComponent_Template_form_ngSubmit_9_listener() {\n              return ctx.publish();\n            });\n            i0.ɵɵelement(10, \"input\", 7)(11, \"textarea\", 8);\n            i0.ɵɵelementStart(12, \"div\", 9)(13, \"button\", 10);\n            i0.ɵɵtext(14, \"Publier\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(15, \"button\", 11);\n            i0.ɵɵlistener(\"click\", function DashboardAgriculteurComponent_Template_button_click_15_listener() {\n              return ctx.publishForm.reset();\n            });\n            i0.ɵɵtext(16, \"Annuler\");\n            i0.ɵɵelementEnd()()();\n            i0.ɵɵtemplate(17, DashboardAgriculteurComponent_div_17_Template, 5, 1, \"div\", 12);\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(18, \"div\", 4)(19, \"h2\", 5);\n            i0.ɵɵtext(20, \"Demande de subvention / investissement\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(21, \"p\", 13);\n            i0.ɵɵtext(22, \"Formulaires de demande (subvention / investissement) \\u2014 visibilit\\u00E9 pour les institutions et investisseurs.\");\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(23, \"div\", 4)(24, \"h2\", 5);\n            i0.ɵɵtext(25, \"Catalogue de semences\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(26, \"p\", 13);\n            i0.ɵɵtext(27, \"Consultez le catalogue, commandez et payez pour am\\u00E9liorer votre production.\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵtemplate(28, DashboardAgriculteurComponent_div_28_Template, 2, 0, \"div\", 14)(29, DashboardAgriculteurComponent_div_29_Template, 2, 1, \"div\", 15);\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(30, \"aside\", 16)(31, \"div\", 17)(32, \"h3\", 18);\n            i0.ɵɵtext(33, \"Notifications\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(34, \"ul\");\n            i0.ɵɵtemplate(35, DashboardAgriculteurComponent_li_35_Template, 5, 2, \"li\", 19);\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(36, \"div\", 17)(37, \"h3\", 18);\n            i0.ɵɵtext(38, \"Compte bancaire\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(39, \"p\", 13);\n            i0.ɵɵtext(40, \"Ajouter un compte pour recevoir paiements et subventions.\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(41, \"form\", 20);\n            i0.ɵɵlistener(\"ngSubmit\", function DashboardAgriculteurComponent_Template_form_ngSubmit_41_listener() {\n              return ctx.saveBankAccount();\n            });\n            i0.ɵɵelement(42, \"input\", 21)(43, \"input\", 22);\n            i0.ɵɵelementStart(44, \"div\", 9)(45, \"button\", 23);\n            i0.ɵɵtext(46, \"Enregistrer\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(47, \"button\", 24);\n            i0.ɵɵlistener(\"click\", function DashboardAgriculteurComponent_Template_button_click_47_listener() {\n              return ctx.bankForm.reset();\n            });\n            i0.ɵɵtext(48, \"Annuler\");\n            i0.ɵɵelementEnd()()()();\n            i0.ɵɵelementStart(49, \"div\", 17)(50, \"h3\", 18);\n            i0.ɵɵtext(51, \"Alertes / Conseils Agronomes\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(52, \"p\", 13);\n            i0.ɵɵtext(53, \"Recevez des alertes filtr\\u00E9es par r\\u00E9gion.\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵtemplate(54, DashboardAgriculteurComponent_div_54_Template, 2, 0, \"div\", 25)(55, DashboardAgriculteurComponent_ul_55_Template, 2, 1, \"ul\", 26);\n            i0.ɵɵelementEnd()()()();\n            i0.ɵɵelement(56, \"app-footer\");\n          }\n          if (rf & 2) {\n            i0.ɵɵadvance(9);\n            i0.ɵɵproperty(\"formGroup\", ctx.publishForm);\n            i0.ɵɵadvance(8);\n            i0.ɵɵproperty(\"ngIf\", ctx.announcements.length);\n            i0.ɵɵadvance(11);\n            i0.ɵɵproperty(\"ngIf\", ctx.seeds.length === 0);\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", ctx.seeds.length > 0);\n            i0.ɵɵadvance(6);\n            i0.ɵɵproperty(\"ngForOf\", ctx.notifications);\n            i0.ɵɵadvance(6);\n            i0.ɵɵproperty(\"formGroup\", ctx.bankForm);\n            i0.ɵɵadvance(13);\n            i0.ɵɵproperty(\"ngIf\", ctx.alerts.length === 0);\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", ctx.alerts.length > 0);\n          }\n        },\n        dependencies: [CommonModule, i3.NgForOf, i3.NgIf, RouterModule, HeaderComponent, FooterComponent, ReactiveFormsModule, i2.ɵNgNoValidate, i2.DefaultValueAccessor, i2.NumberValueAccessor, i2.NgControlStatus, i2.NgControlStatusGroup, i2.MinValidator, i2.FormGroupDirective, i2.FormControlName, FormsModule, i2.NgModel],\n        encapsulation: 2\n      });\n    }\n  }\n  return DashboardAgriculteurComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}