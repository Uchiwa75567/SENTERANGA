{"ast":null,"code":"import { CommonModule } from '@angular/common';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../services/data.service\";\nimport * as i2 from \"@angular/common\";\nfunction ProductCardComponent_span_15_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 23);\n    i0.ɵɵtext(1, \"\\uD83D\\uDCE2 Annonce\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ProductCardComponent_span_16_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 24);\n    i0.ɵɵtext(1, \"Stock disponible\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ProductCardComponent_span_17_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 25);\n    i0.ɵɵtext(1, \"R\\u00E9serv\\u00E9\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ProductCardComponent_span_18_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 26);\n    i0.ɵɵtext(1, \"Vendu\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ProductCardComponent_span_19_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 27);\n    i0.ɵɵtext(1, \"En attente\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ProductCardComponent_span_20_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 28);\n    i0.ɵɵtext(1, \"\\u23F3 Validation admin\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ProductCardComponent_span_21_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 29);\n    i0.ɵɵtext(1, \"\\uD83D\\uDCC5 Bient\\u00F4t disponible\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ProductCardComponent_span_22_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 24);\n    i0.ɵɵtext(1, \"\\u2705 Disponible\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ProductCardComponent_div_28_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 30)(1, \"div\", 9);\n    i0.ɵɵtext(2, \"\\uD83D\\uDCC5 Disponibilit\\u00E9:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"div\");\n    i0.ɵɵtext(4);\n    i0.ɵɵpipe(5, \"date\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"div\");\n    i0.ɵɵtext(7);\n    i0.ɵɵpipe(8, \"date\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\"Du \", i0.ɵɵpipeBind2(5, 2, ctx_r0.product.periodeApproximativeDebut, \"dd/MM/yyyy\"), \"\");\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\"Au \", i0.ɵɵpipeBind2(8, 5, ctx_r0.product.periodeApproximativeFin, \"dd/MM/yyyy\"), \"\");\n  }\n}\n// Product coming from API has fields like titre, images[], agriculteurId, quantiteMinimale, prixParUnite, unite, localisation\nexport let ProductCardComponent = /*#__PURE__*/(() => {\n  class ProductCardComponent {\n    constructor(dataService) {\n      this.dataService = dataService;\n      this.producerName = null;\n    }\n    ngOnInit() {\n      if (this.product && this.product.agriculteurId) {\n        this.dataService.getTestUsers().subscribe(users => {\n          const u = (users || []).find(x => x.id === this.product.agriculteurId);\n          this.producerName = u ? `${u.firstName} ${u.lastName}` : this.product.agriculteurId;\n        }, err => {\n          console.error('Failed to load producer name', err);\n        });\n      }\n    }\n    // helper to get first image url/base64\n    getImage() {\n      if (!this.product) return '';\n      if (Array.isArray(this.product.images) && this.product.images.length > 0) return this.product.images[0];\n      // fallback: maybe product.image or product.photo\n      return this.product.image || this.product.photo || '';\n    }\n    // Check if product is an announcement\n    isAnnouncement() {\n      return this.product?.isAnnonce === true;\n    }\n    // Check if announcement is available (validated and within date range)\n    isAnnouncementAvailable() {\n      if (!this.isAnnouncement()) return false;\n      // Must be validated by admin\n      if (this.product?.statutAnnonce !== 'validee') return false;\n      // Check if current date is within the availability period\n      const now = new Date();\n      const startDate = this.product?.periodeApproximativeDebut ? new Date(this.product.periodeApproximativeDebut) : null;\n      const endDate = this.product?.periodeApproximativeFin ? new Date(this.product.periodeApproximativeFin) : null;\n      if (!startDate || !endDate) return false;\n      return now >= startDate && now <= endDate;\n    }\n    // Get the appropriate button text\n    getButtonText() {\n      if (this.isAnnouncement() && !this.isAnnouncementAvailable()) {\n        return 'Réservation';\n      }\n      return 'Ajouter au panier';\n    }\n    // Check if button should be disabled\n    isButtonDisabled() {\n      if (this.isAnnouncement() && !this.isAnnouncementAvailable()) {\n        return false; // Reservation button is always enabled\n      }\n      // For regular products, check availability\n      return this.product?.statutDisponibilite === 'vendu' || this.product?.statutValidation !== 'validé';\n    }\n    static {\n      this.ɵfac = function ProductCardComponent_Factory(t) {\n        return new (t || ProductCardComponent)(i0.ɵɵdirectiveInject(i1.DataService));\n      };\n    }\n    static {\n      this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n        type: ProductCardComponent,\n        selectors: [[\"app-product-card\"]],\n        inputs: {\n          product: \"product\"\n        },\n        standalone: true,\n        features: [i0.ɵɵStandaloneFeature],\n        decls: 34,\n        vars: 26,\n        consts: [[1, \"bg-white\", \"rounded-xl\", \"overflow-hidden\", \"shadow-md\", \"hover:shadow-xl\", \"transition-shadow\"], [1, \"relative\", \"h-48\", \"rounded-t-xl\", \"overflow-hidden\"], [1, \"absolute\", \"bottom-3\", \"left-3\", \"bg-white/95\", \"px-3\", \"py-1\", \"rounded-md\", \"shadow-sm\"], [1, \"text-sm\", \"font-bold\", \"text-gray-900\"], [1, \"absolute\", \"top-3\", \"right-3\", \"w-7\", \"h-7\", \"bg-white\", \"rounded-full\", \"flex\", \"items-center\", \"justify-center\", \"shadow-sm\", \"hover:bg-gray-50\", \"transition-colors\"], [\"fill\", \"currentColor\", \"viewBox\", \"0 0 24 24\", 1, \"w-4\", \"h-4\", \"text-gray-600\"], [\"d\", \"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z\"], [1, \"p-3\", \"space-y-2\"], [1, \"text-xs\", \"text-gray-600\"], [1, \"font-semibold\"], [1, \"flex\", \"items-center\", \"gap-2\", \"flex-wrap\"], [\"class\", \"px-2 py-0.5 rounded text-xs font-semibold bg-purple-50 text-purple-600\", 4, \"ngIf\"], [\"class\", \"px-2 py-0.5 rounded text-xs font-semibold bg-green-50 text-green-600\", 4, \"ngIf\"], [\"class\", \"px-2 py-0.5 rounded text-xs font-semibold bg-yellow-50 text-yellow-700\", 4, \"ngIf\"], [\"class\", \"px-2 py-0.5 rounded text-xs font-semibold bg-red-50 text-red-700\", 4, \"ngIf\"], [\"class\", \"px-2 py-0.5 rounded text-xs font-semibold bg-yellow-100 text-yellow-800\", 4, \"ngIf\"], [\"class\", \"px-2 py-0.5 rounded text-xs font-semibold bg-orange-50 text-orange-600\", 4, \"ngIf\"], [\"class\", \"px-2 py-0.5 rounded text-xs font-semibold bg-blue-50 text-blue-600\", 4, \"ngIf\"], [1, \"flex\", \"items-center\", \"justify-between\", \"text-xs\", \"font-bold\", \"text-gray-900\"], [\"class\", \"text-xs text-purple-600 bg-purple-50 p-2 rounded\", 4, \"ngIf\"], [1, \"flex\", \"gap-2\", \"pt-1\"], [3, \"disabled\"], [1, \"flex-1\", \"text-senteranga-green\", \"text-xs\", \"font-semibold\", \"py-2\", \"border\", \"border-senteranga-green\", \"rounded\", \"hover:bg-green-50\", \"transition-colors\"], [1, \"px-2\", \"py-0.5\", \"rounded\", \"text-xs\", \"font-semibold\", \"bg-purple-50\", \"text-purple-600\"], [1, \"px-2\", \"py-0.5\", \"rounded\", \"text-xs\", \"font-semibold\", \"bg-green-50\", \"text-green-600\"], [1, \"px-2\", \"py-0.5\", \"rounded\", \"text-xs\", \"font-semibold\", \"bg-yellow-50\", \"text-yellow-700\"], [1, \"px-2\", \"py-0.5\", \"rounded\", \"text-xs\", \"font-semibold\", \"bg-red-50\", \"text-red-700\"], [1, \"px-2\", \"py-0.5\", \"rounded\", \"text-xs\", \"font-semibold\", \"bg-yellow-100\", \"text-yellow-800\"], [1, \"px-2\", \"py-0.5\", \"rounded\", \"text-xs\", \"font-semibold\", \"bg-orange-50\", \"text-orange-600\"], [1, \"px-2\", \"py-0.5\", \"rounded\", \"text-xs\", \"font-semibold\", \"bg-blue-50\", \"text-blue-600\"], [1, \"text-xs\", \"text-purple-600\", \"bg-purple-50\", \"p-2\", \"rounded\"]],\n        template: function ProductCardComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"div\", 2)(3, \"span\", 3);\n            i0.ɵɵtext(4);\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(5, \"button\", 4);\n            i0.ɵɵnamespaceSVG();\n            i0.ɵɵelementStart(6, \"svg\", 5);\n            i0.ɵɵelement(7, \"path\", 6);\n            i0.ɵɵelementEnd()()();\n            i0.ɵɵnamespaceHTML();\n            i0.ɵɵelementStart(8, \"div\", 7)(9, \"div\", 8)(10, \"p\", 9);\n            i0.ɵɵtext(11);\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(12, \"p\");\n            i0.ɵɵtext(13);\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(14, \"div\", 10);\n            i0.ɵɵtemplate(15, ProductCardComponent_span_15_Template, 2, 0, \"span\", 11)(16, ProductCardComponent_span_16_Template, 2, 0, \"span\", 12)(17, ProductCardComponent_span_17_Template, 2, 0, \"span\", 13)(18, ProductCardComponent_span_18_Template, 2, 0, \"span\", 14)(19, ProductCardComponent_span_19_Template, 2, 0, \"span\", 15)(20, ProductCardComponent_span_20_Template, 2, 0, \"span\", 16)(21, ProductCardComponent_span_21_Template, 2, 0, \"span\", 17)(22, ProductCardComponent_span_22_Template, 2, 0, \"span\", 12);\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(23, \"div\", 18)(24, \"span\");\n            i0.ɵɵtext(25);\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(26, \"span\");\n            i0.ɵɵtext(27);\n            i0.ɵɵelementEnd()();\n            i0.ɵɵtemplate(28, ProductCardComponent_div_28_Template, 9, 8, \"div\", 19);\n            i0.ɵɵelementStart(29, \"div\", 20)(30, \"button\", 21);\n            i0.ɵɵtext(31);\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(32, \"button\", 22);\n            i0.ɵɵtext(33, \" Discuter en ligne \");\n            i0.ɵɵelementEnd()()()();\n          }\n          if (rf & 2) {\n            i0.ɵɵadvance();\n            i0.ɵɵstyleProp(\"background-image\", \"url(\" + ctx.getImage() + \")\")(\"background-size\", \"cover\")(\"background-position\", \"center\");\n            i0.ɵɵadvance(3);\n            i0.ɵɵtextInterpolate(ctx.product.titre || ctx.product.name);\n            i0.ɵɵadvance(7);\n            i0.ɵɵtextInterpolate1(\"Producteur: \", ctx.producerName || ctx.product.agriculteurId, \"\");\n            i0.ɵɵadvance(2);\n            i0.ɵɵtextInterpolate(ctx.product.localisation);\n            i0.ɵɵadvance(2);\n            i0.ɵɵproperty(\"ngIf\", ctx.isAnnouncement());\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", ctx.product.statutDisponibilite === \"disponible\" && !ctx.isAnnouncement());\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", ctx.product.statutDisponibilite === \"reserv\\u00E9\" && !ctx.isAnnouncement());\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", ctx.product.statutDisponibilite === \"vendu\");\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", ctx.product.statutValidation === \"en_attente\");\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", ctx.isAnnouncement() && ctx.product.statutAnnonce === \"en_attente\");\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", ctx.isAnnouncement() && ctx.product.statutAnnonce === \"validee\" && !ctx.isAnnouncementAvailable());\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", ctx.isAnnouncement() && ctx.product.statutAnnonce === \"validee\" && ctx.isAnnouncementAvailable());\n            i0.ɵɵadvance(3);\n            i0.ɵɵtextInterpolate2(\"Quantit\\u00E9 min : \", ctx.product.quantiteMinimale || ctx.product.quantite || \"-\", \" \", ctx.product.unite || \"\", \"\");\n            i0.ɵɵadvance(2);\n            i0.ɵɵtextInterpolate2(\"\", ctx.product.prixParUnite || ctx.product.prix, \" FCFA/\", ctx.product.unite === \"kg\" ? \"Kg\" : ctx.product.unite || \"unit\\u00E9\", \"\");\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", ctx.isAnnouncement() && ctx.product.periodeApproximativeDebut && ctx.product.periodeApproximativeFin);\n            i0.ɵɵadvance(2);\n            i0.ɵɵclassMap(ctx.isAnnouncement() && !ctx.isAnnouncementAvailable() ? \"flex-1 bg-blue-600 text-white text-xs font-semibold py-2 rounded hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors\" : \"flex-1 bg-senteranga-green text-white text-xs font-semibold py-2 rounded hover:bg-senteranga-green-dark disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors\");\n            i0.ɵɵproperty(\"disabled\", ctx.isButtonDisabled());\n            i0.ɵɵadvance();\n            i0.ɵɵtextInterpolate1(\" \", ctx.getButtonText(), \" \");\n          }\n        },\n        dependencies: [CommonModule, i2.NgIf, i2.DatePipe],\n        encapsulation: 2\n      });\n    }\n  }\n  return ProductCardComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}